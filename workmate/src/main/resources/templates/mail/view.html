<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/mail_layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <title>ë°›ì€ ë©”ì¼ ë³´ê¸°</title>
    <link rel="stylesheet" href="https://cdn.quilljs.com/1.3.6/quill.snow.css">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <style>
        .container { width: 80%; margin: 20px auto; }
        #editor-container {
            height: 400px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <h2 class="mb-4">ë°›ì€ ë©”ì¼ ìƒì„¸ ì¡°íšŒ</h2>

    <!-- ë²„íŠ¼ ì˜ì—­ -->
    <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-danger btn-sm me-2" onclick="deleteMail()">ì‚­ì œ</button>
        <button class="btn btn-secondary btn-sm me-2">ì´ë™</button>
        <button class="btn btn-primary btn-sm me-2" onclick="replyMail()">íšŒì‹ </button>
        <button class="btn btn-warning btn-sm" onclick="convertToTask()">ì—…ë¬´ ì „í™˜</button>
    </div>

    <div class="card">
        <div class="card-body">
            <!-- ë©”ì¼ ìƒì„¸ ë‚´ìš© -->
            <p><strong>ë³´ë‚¸ ì‚¬ëŒ:</strong> <span th:text="${mail.senderEmail}"></span></p>
            <p><strong>ìˆ˜ì‹ ì:</strong> <span th:text="${mail.recipients}"></span></p>
            <p><strong>ì œëª©:</strong> <span th:text="${mail.subject}"></span></p>
            <p><strong>ë‚ ì§œ:</strong>
                <span th:text="${#dates.format(mail.sentAt, 'yyyy-MM-dd HH:mm')}"></span></p>

            <hr>

            <!-- ë©”ì¼ ë³¸ë¬¸ -->
            <div class="border p-3">
                <div th:utext="${mail.content}"></div>
            </div>

            <!-- ì²¨ë¶€íŒŒì¼ -->
            <div th:if="${mail.attachmentList != null and #lists.size(mail.attachmentList) > 0}" class="mt-3">
                <h5>ğŸ“ ì²¨ë¶€íŒŒì¼</h5>
                <ul>
                    <li th:each="file : ${mail.attachmentList}">
                        <a th:href="@{/mail/download/{fileId}(fileId=${file.fileId})}" th:text="${file.fileName}"></a>
                        (<span th:text="${#numbers.formatInteger(file.fileSize / 1024, 0)}"></span> KB)
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸° -->
    <div class="mt-3">
        <a th:href="@{/mail/mailmain}" class="btn btn-outline-dark">ëª©ë¡ìœ¼ë¡œ</a>
    </div>
</div>
</body>
</html>
