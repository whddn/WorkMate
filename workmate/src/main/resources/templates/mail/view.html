<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/mail_layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <title>λ°›μ€ λ©”μΌ λ³΄κΈ°</title>
    <link rel="stylesheet" href="https://cdn.quilljs.com/1.3.6/quill.snow.css">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <style>
        .container { width: 80%; margin: 20px auto; }
        #editor-container {
            height: 400px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <h2 class="mb-4">λ°›μ€ λ©”μΌ μƒμ„Έ μ΅°ν</h2>

    <!-- λ²„νΌ -->
    <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-danger btn-sm me-2" onclick="deleteMail()">μ‚­μ </button>
        <button class="btn btn-secondary btn-sm me-2">μ΄λ™</button>
        <a th:href="@{/mail/composeReply(recipient=${mail.senderEmail})}" class="btn btn-primary btn-sm me-2">
    νμ‹ 
</a>
    </div>

    <div class="card">
        <div class="card-body">
            <!-- π“¬ λ©”μΌ μƒμ„Έ λ‚΄μ© -->
            <p><strong>λ³΄λ‚Έ μ‚¬λ:</strong> <span th:text="${mail.senderEmail}"></span></p>
            <p><strong>μμ‹ μ:</strong> <span th:text="${mail.recipients}"></span></p>
            <p><strong>μ°Έμ΅°:</strong> <span th:text="${mail.ccList}">-</span></p>
            <p><strong>μ λ©:</strong> <span th:text="${mail.subject}"></span></p>
            <p><strong>λ‚ μ§:</strong> <span th:text="${#dates.format(mail.sentAt, 'yyyy-MM-dd HH:mm')}"></span></p>

            <hr>

            <!-- λ³Έλ¬Έ -->
            <div class="border p-3">
                <div th:utext="${mail.content}"></div>
            </div>

            <!-- μ²¨λ¶€νμΌ -->
            <div th:if="${mail.attachmentList != null and #lists.size(mail.attachmentList) > 0}" class="mt-3">
    <h5>π“ μ²¨λ¶€νμΌ</h5>
    <ul>
        <li th:each="file : ${mail.attachmentList}">
            <a th:href="@{/mail/download/{fileId}(fileId=${file.fileId})}" th:text="${file.fileName}"></a>
            (<span th:text="${#numbers.formatInteger(file.fileSize / 1024, 0)}"></span> KB)
            <span th:if="${mail.encrypted == 'Y'}" class="text-danger"> - (μ•”νΈν™”λ¨)</span>
        </li>
    </ul>

    <!-- π”’ μ•”νΈν™” μ•λ‚΄λ¬Έ -->
    <div th:if="${mail.encrypted == 'Y'}" class="alert alert-warning mt-3">
        μ΄ λ©”μΌμ μ²¨λ¶€νμΌμ€ μ•”νΈν™”λμ–΄ μμµλ‹λ‹¤.<br>
        μ••μ¶• νμΌμ„ μ—΄ λ• λΉ„λ°€λ²νΈλ¥Ό μ…λ ¥ν•΄μ£Όμ„Έμ”.
    </div>
</div>
        </div>
    </div>

    <!-- λ©λ΅μΌλ΅ -->
    <div class="mt-3">
        <a th:href="@{/mail/mailmain}" class="btn btn-outline-dark">λ©λ΅μΌλ΅</a>
    </div>
</div>
</body>
</html>
